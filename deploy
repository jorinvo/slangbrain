#!/bin/bash
set -e

# Build, and deploy latest version of Slangbrain to the live server.

echo - building binary
GOOS=linux go build -a -ldflags '-s -w' -o dist/slangbrain

echo - moving old binary
ssh qvl.io mv /home/jorin/bin/slangbrain /tmp/slangbrain-$(date +%s)

echo - uploading to server
scp dist/slangbrain qvl.io:/home/jorin/bin/slangbrain

echo - restarting service
ssh -t qvl.io sudo systemctl reload slangbrain

echo - all good
